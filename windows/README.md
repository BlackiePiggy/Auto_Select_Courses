# SJTU选课自动检漏脚本
## 使用方法
1. 打开config.py文件，确保自己屏幕的分辨率在可选分辨率中；
2. 如果你只想捡一门课，请打开main.py文件，注释掉

    #-----------------------------Second Class--------------------------------

    ...
    ...
    ...

    #-------------------------------------------------------------------------

    这段内容；

3. 打开win_gui.py,在函数 `search_first_class()`中，将`pc.copy('xxxxx')` 中的 `xxxxx` 更换为自己课程的名称。请提前确保在选课系统中搜索课程名称出现的结果唯一；
4. 页面停留在选课系统，在程序文件夹下打开cmd，将cmd框拖拽到右下角，保证页面左上部分区域显示的是选课系统页面；
5. 输入 `python main.py` ，回车运行。
6. 如果要加入多门课程同时捡漏，请同理修改 main.py 和 win_gui.py 中相关函数。
7. 运行log会存在logs文件下，用户可进行查看。

## 依赖库
见requirements.txt。
```
matplotlib==3.8.2
numpy==1.26.2
opencv_python==4.8.1.78
Pillow==10.1.0
Pillow==10.1.0
PyAutoGUI==0.9.54
pyperclip==1.8.2
Requests==2.31.0
```

## 项目技术方案
- OpenCV进行颜色识别

    对选课界面的选课人数数字进行截图，判断其是红色还是绿色，如果为绿色，则执行选课的点击操作，否则刷新界面，重新检测。
- pyautogui实现自动操作鼠标和键盘

    截图位置，鼠标点击位置在不同浏览器中，不同用户界面中不同。
    
    如果无法正确点击，请自行修改每次 `    left, top, width, height = 1600, 385, 50, 20`   和 `pg.moveTo(468,207)` 中的相关数字。

    使用`pyautogui`函数可以获取鼠标当前位置
    ```
    import pyautogui
    pyautogui.position()
    ```
    

- 微信/短信/电话提醒
    
    当检测到课程可选时，通过多种方式进行实时提醒。
    实现方法：
    微信搜索“喵提醒”，获取提醒链接，替换掉main.py中 
    
    `r = requests.get('http://miaotixing.com/trigger?id=tuj1K0C')` 
    
    get框中的内容。原理是当向提醒链接发起网络请求时，会自动触发相关提醒。

